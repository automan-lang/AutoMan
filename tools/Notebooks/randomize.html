<!DOCTYPE html>
<html>

<head>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/seedrandom/3.0.5/seedrandom.min.js">
  </script>
</head>

<body>
  <script src="https://assets.crowd.aws/crowd-html-elements.js"></script>
  <h1>How do you think young adults today compare with their parents' generation on each of the following?</h1>
  <p>For the following questions, is this action easier, harder, or the same for young adults today compared to their
    parents' generation?</p>
  <crowd-form>
    <div id="container">

      <div id=727d4914-85d7-4e5d-8024-0d5af55027ac">
        <div class="QuestionContent">
          <p>Saving for the future</p>
        </div>
        <div class="options">
          <input type="radio" id="727d4914-85d7-4e5d-8024-0d5af55027ac-'Easier"
            name="727d4914-85d7-4e5d-8024-0d5af55027ac" value="'Easier" required />
          <label for="727d4914-85d7-4e5d-8024-0d5af55027ac-'Easier">Easier</label>
        </div>
        <div class="options">
          <input type="radio" id="727d4914-85d7-4e5d-8024-0d5af55027ac-'Harder"
            name="727d4914-85d7-4e5d-8024-0d5af55027ac" value="'Harder" required />
          <label for="727d4914-85d7-4e5d-8024-0d5af55027ac-'Harder">Harder</label>
        </div>
        <div class="options">
          <input type="radio" id="727d4914-85d7-4e5d-8024-0d5af55027ac-'Same"
            name="727d4914-85d7-4e5d-8024-0d5af55027ac" value="'Same" required />
          <label for="727d4914-85d7-4e5d-8024-0d5af55027ac-'Same">About the same</label>
        </div>
      </div>

      <div id=40b468aa-4354-4679-a297-068cc7d8f897">
        <div class="QuestionContent">
          <p>Paying for college</p>
        </div>
        <div class="options">
          <input type="radio" id="40b468aa-4354-4679-a297-068cc7d8f897-'Easier"
            name="40b468aa-4354-4679-a297-068cc7d8f897" value="'Easier" required />
          <label for="40b468aa-4354-4679-a297-068cc7d8f897-'Easier">Easier</label>
        </div>
        <div class="options">
          <input type="radio" id="40b468aa-4354-4679-a297-068cc7d8f897-'Harder"
            name="40b468aa-4354-4679-a297-068cc7d8f897" value="'Harder" required />
          <label for="40b468aa-4354-4679-a297-068cc7d8f897-'Harder">Harder</label>
        </div>
        <div class="options">
          <input type="radio" id="40b468aa-4354-4679-a297-068cc7d8f897-'Same"
            name="40b468aa-4354-4679-a297-068cc7d8f897" value="'Same" required />
          <label for="40b468aa-4354-4679-a297-068cc7d8f897-'Same">About the same</label>
        </div>
      </div>

      <div id=0ad80e72-02e7-4cfc-a298-cc1568f665ff">
        <div class="QuestionContent">
          <p>Buying a home</p>
        </div>
        <div class="options">
          <input type="radio" id="0ad80e72-02e7-4cfc-a298-cc1568f665ff-'Easier"
            name="0ad80e72-02e7-4cfc-a298-cc1568f665ff" value="'Easier" required />
          <label for="0ad80e72-02e7-4cfc-a298-cc1568f665ff-'Easier">Easier</label>
        </div>
        <div class="options">
          <input type="radio" id="0ad80e72-02e7-4cfc-a298-cc1568f665ff-'Harder"
            name="0ad80e72-02e7-4cfc-a298-cc1568f665ff" value="'Harder" required />
          <label for="0ad80e72-02e7-4cfc-a298-cc1568f665ff-'Harder">Harder</label>
        </div>
        <div class="options">
          <input type="radio" id="0ad80e72-02e7-4cfc-a298-cc1568f665ff-'Same"
            name="0ad80e72-02e7-4cfc-a298-cc1568f665ff" value="'Same" required />
          <label for="0ad80e72-02e7-4cfc-a298-cc1568f665ff-'Same">About the same</label>
        </div>
      </div>

      <div id=f73efca0-d7fb-4fb6-9527-884cac8aac41">
        <div class="QuestionContent">
          <p>Finding a spouse or partner</p>
        </div>
        <div class="options">
          <input type="radio" id="f73efca0-d7fb-4fb6-9527-884cac8aac41-'Easier"
            name="f73efca0-d7fb-4fb6-9527-884cac8aac41" value="'Easier" required />
          <label for="f73efca0-d7fb-4fb6-9527-884cac8aac41-'Easier">Easier</label>
        </div>
        <div class="options">
          <input type="radio" id="f73efca0-d7fb-4fb6-9527-884cac8aac41-'Harder"
            name="f73efca0-d7fb-4fb6-9527-884cac8aac41" value="'Harder" required />
          <label for="f73efca0-d7fb-4fb6-9527-884cac8aac41-'Harder">Harder</label>
        </div>
        <div class="options">
          <input type="radio" id="f73efca0-d7fb-4fb6-9527-884cac8aac41-'Same"
            name="f73efca0-d7fb-4fb6-9527-884cac8aac41" value="'Same" required />
          <label for="f73efca0-d7fb-4fb6-9527-884cac8aac41-'Same">About the same</label>
        </div>
      </div>

      <div id=2b6374ec-59d9-4ef2-9d8d-3eb910870b4d">
        <div class="QuestionContent">
          <p>Finding a job</p>
        </div>
        <div class="options">
          <input type="radio" id="2b6374ec-59d9-4ef2-9d8d-3eb910870b4d-'Easier"
            name="2b6374ec-59d9-4ef2-9d8d-3eb910870b4d" value="'Easier" required />
          <label for="2b6374ec-59d9-4ef2-9d8d-3eb910870b4d-'Easier">Easier</label>
        </div>
        <div class="options">
          <input type="radio" id="2b6374ec-59d9-4ef2-9d8d-3eb910870b4d-'Harder"
            name="2b6374ec-59d9-4ef2-9d8d-3eb910870b4d" value="'Harder" required />
          <label for="2b6374ec-59d9-4ef2-9d8d-3eb910870b4d-'Harder">Harder</label>
        </div>
        <div class="options">
          <input type="radio" id="2b6374ec-59d9-4ef2-9d8d-3eb910870b4d-'Same"
            name="2b6374ec-59d9-4ef2-9d8d-3eb910870b4d" value="'Same" required />
          <label for="2b6374ec-59d9-4ef2-9d8d-3eb910870b4d-'Same">About the same</label>
        </div>
      </div>

      <div id=8f511d04-bcba-43a6-ac5f-eccdf5f049af">
        <div class="QuestionContent">
          <p>Getting into college</p>
        </div>
        <div class="options">
          <input type="radio" id="8f511d04-bcba-43a6-ac5f-eccdf5f049af-'Easier"
            name="8f511d04-bcba-43a6-ac5f-eccdf5f049af" value="'Easier" required />
          <label for="8f511d04-bcba-43a6-ac5f-eccdf5f049af-'Easier">Easier</label>
        </div>
        <div class="options">
          <input type="radio" id="8f511d04-bcba-43a6-ac5f-eccdf5f049af-'Harder"
            name="8f511d04-bcba-43a6-ac5f-eccdf5f049af" value="'Harder" required />
          <label for="8f511d04-bcba-43a6-ac5f-eccdf5f049af-'Harder">Harder</label>
        </div>
        <div class="options">
          <input type="radio" id="8f511d04-bcba-43a6-ac5f-eccdf5f049af-'Same"
            name="8f511d04-bcba-43a6-ac5f-eccdf5f049af" value="'Same" required />
          <label for="8f511d04-bcba-43a6-ac5f-eccdf5f049af-'Same">About the same</label>
        </div>
      </div>

      <div id=c799476d-db52-4dfe-a5f2-187e3894d280">
        <div class="QuestionContent">
          <p>Staying in touch with family and friends</p>
        </div>
        <div class="options">
          <input type="radio" id="c799476d-db52-4dfe-a5f2-187e3894d280-'Easier"
            name="c799476d-db52-4dfe-a5f2-187e3894d280" value="'Easier" required />
          <label for="c799476d-db52-4dfe-a5f2-187e3894d280-'Easier">Easier</label>
        </div>
        <div class="options">
          <input type="radio" id="c799476d-db52-4dfe-a5f2-187e3894d280-'Harder"
            name="c799476d-db52-4dfe-a5f2-187e3894d280" value="'Harder" required />
          <label for="c799476d-db52-4dfe-a5f2-187e3894d280-'Harder">Harder</label>
        </div>
        <div class="options">
          <input type="radio" id="c799476d-db52-4dfe-a5f2-187e3894d280-'Same"
            name="c799476d-db52-4dfe-a5f2-187e3894d280" value="'Same" required />
          <label for="c799476d-db52-4dfe-a5f2-187e3894d280-'Same">About the same</label>
        </div>
      </div>

      <div id=1b56e8be-127c-47d3-9864-31fceb586234">
        <div class="QuestionContent">
          <p>Do you currently live in the United States?</p>
        </div>
        <div class="options">
          <input type="radio" id="1b56e8be-127c-47d3-9864-31fceb586234-'Yes" name="1b56e8be-127c-47d3-9864-31fceb586234"
            value="'Yes" required />
          <label for="1b56e8be-127c-47d3-9864-31fceb586234-'Yes">Yes</label>
        </div>
        <div class="options">
          <input type="radio" id="1b56e8be-127c-47d3-9864-31fceb586234-'No" name="1b56e8be-127c-47d3-9864-31fceb586234"
            value="'No" required />
          <label for="1b56e8be-127c-47d3-9864-31fceb586234-'No">No</label>
        </div>
      </div>

      <div id=d73751f3-b779-4351-914b-8605dd5c0bfc">
        <div class="QuestionContent" style="margin-bottom: -2em;">
          <p>What is your age?</p>
        </div>
        <crowd-input name="d73751f3-b779-4351-914b-8605dd5c0bfc" label="What is your age?" allowed-pattern="^\d*$"
          error-message="Please enter ONLY numbers" auto-validate required>
        </crowd-input>
      </div>
    </div>
  </crowd-form>

  <div>
    <input type="text" id="seed" />
    <button id="shuffle" type="button">Click to randomize</button>
    <button id="reset" type="button">Click to re-sort</button>
  </div>

  <script>
    const shuffleNodes = () => {
      const list = document.getElementById("container");
      let seed = document.getElementById("seed").value;

      // a custom seeded PRNG function generator.
      // Taken from https://stackoverflow.com/a/47593316/6604166
      function cyrb128(str) {
        let h1 = 1779033703, h2 = 3144134277,
          h3 = 1013904242, h4 = 2773480762;
        for (let i = 0, k; i < str.length; i++) {
          k = str.charCodeAt(i);
          h1 = h2 ^ Math.imul(h1 ^ k, 597399067);
          h2 = h3 ^ Math.imul(h2 ^ k, 2869860233);
          h3 = h4 ^ Math.imul(h3 ^ k, 951274213);
          h4 = h1 ^ Math.imul(h4 ^ k, 2716044179);
        }
        h1 = Math.imul(h3 ^ (h1 >>> 18), 597399067);
        h2 = Math.imul(h4 ^ (h2 >>> 22), 2869860233);
        h3 = Math.imul(h1 ^ (h3 >>> 17), 951274213);
        h4 = Math.imul(h2 ^ (h4 >>> 19), 2716044179);
        return [(h1 ^ h2 ^ h3 ^ h4) >>> 0, (h2 ^ h1) >>> 0, (h3 ^ h1) >>> 0, (h4 ^ h1) >>> 0];
      }

      const sfc32 = (a, b, c, d) => {
        return function () {
          a >>>= 0; b >>>= 0; c >>>= 0; d >>>= 0;
          var t = (a + b) | 0;
          a = b ^ b >>> 9;
          b = c + (c << 3) | 0;
          c = (c << 21 | c >>> 11);
          d = d + 1 | 0;
          t = t + d | 0;
          c = c + t | 0;
          return (t >>> 0) / 4294967296;
        }
      }

      // the Knuth shuffle, where prng returns [0..1)
      const shuffle = (items, prng) => {
        let cached = items.slice(0);
        let i = cached.length;
        let temp, rand;
        while (--i > 0) {
          rand = Math.floor((i+1) * prng());
          temp = cached[rand];
          cached[rand] = cached[i];
          cached[i] = temp;
        }
        return cached;
      }

      // Create cyrb128 state:
      // const seedArr = cyrb128(seed);
      // // Output four 32-bit hashes to provide the seed for sfc32.
      // const rand = sfc32(seedArr[0], seedArr[1], seedArr[2], seedArr[3]);

      var myrng = new Math.seedrandom(seed);

      // shuffle questions
      let nodes = list.children, i = 0;
      nodes = Array.prototype.slice.call(nodes);
      nodes = shuffle(nodes, myrng);

      // writeback
      while (i < nodes.length) {
        list.appendChild(nodes[i]);
        ++i;
      }

      // shuffle options within each question
      for (let index = 0; index < nodes.length; index++) {
        const element = nodes[index];
        let childNodes = element.getElementsByClassName("options"), i = 0;

        if (childNodes.length === 0) {
          continue
        }

        console.log(`shuffling options: ${element.id}`)
        childNodes = Array.prototype.slice.call(childNodes);
        childNodes = shuffle(childNodes, myrng);

        // writeback
        while (i < childNodes.length) {
          element.appendChild(childNodes[i]);
          ++i;
        }
        console.log(`written back options: ${element.id}`)
      }
    }

    const button = document.getElementById("shuffle");
    button.onclick = shuffleNodes;

    const resetNodes = () => {
      const list = document.getElementById("container");

      [...list.children]
        .sort((a, b) => a.innerText > b.innerText ? 1 : -1)
        .forEach(node => list.appendChild(node));
    }
    document.getElementById("reset").onclick = resetNodes;
  </script>
</body>

</html>